<!DOCTYPE html>
<html lang="fi">
<head>
    <meta charset="utf-8">
    <title>Vantaan avoimet työpaikat</title>
    <link rel="stylesheet" href="/tyylit.css" type="text/css">
</head>

<script>
    let tulos;

    document.addEventListener('DOMContentLoaded',alusta);

    function alusta() {
        tulos=document.getElementById('tulos');
        haeTiedot();
    }

    function haeTiedot() {
            fetch('http://gis.vantaa.fi/rest/tyopaikat/v1', {mode: 'cors'})
                .then(data=>data.json())
                .then(jsonData=>paivitaTiedot(jsonData))
                .catch(err=>console.log("virhe", err));
    }
    function paivitaTiedot(duunit) {
        tulos.innerHTML='';
        for(let duuni of duunit) {
            console.log(duuni);
            if(duuni.ammattiala=='kaikki'){
                const li=document.createElement('li');
            li.textContent=duuni.ammattiala + ' toimialat yhteensä:' + duuni.lukumäärä + ' kpl';
            tulos.appendChild(li);
            }
           
        }
    }
</script>
<body>
    <h1>Vantaan avoimet työpaikat toimialoittain</h1>
    <ul id="tulos"></ul>

    <div id="barchart"></div>

<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">
// Load google charts
google.charts.load('current', {'packages':['corechart']});
google.charts.setOnLoadCallback(drawChart);

// Draw the chart and set the chart values
function drawChart() {
  var data = new google.visualization.DataTable();
        data.addColumn('string', 'Toimiala');
        data.addColumn('number', 'Lkm');
        data.addRows([
          ['Mushrooms', 3],
          ['Onions', 1],
          ['Olives', 1],
          ['Zucchini', 1],
          ['Pepperoni', 2]
        ]);

  // Optional; add a title and set the width and height of the chart
  var options = {'title':'', 'width':600, 'height':400};

  // Display the chart inside the <div> element
  var chart = new google.visualization.BarChart(document.getElementById('barchart'));
  chart.draw(data, options);
}
</script>
</body>
</html>